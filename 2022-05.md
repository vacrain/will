# Will-2022-05

[toc]

## Learned







### Angularæäº¤è§„èŒƒã€commitlintã€git-czè¾…åŠ©æäº¤å·¥å…·

å¼€æºç¤¾åŒºçš„å¤§é¡¹ç›®ï¼Œä¸€èˆ¬ä½¿ç”¨çš„æ˜¯Angularçš„æäº¤è§„èŒƒ

ä½¿ç”¨ commitlint å¯ä»¥è§„èŒƒæˆ‘ä»¬æ¯ä¸€æ¬¡çš„ commitï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ¥è‡ªåŠ¨ç”Ÿæˆ changeLog ç­‰æ–‡ä»¶ï¼Œæ–¹ä¾¿ä»£ç ç®¡ç†ã€‚



- Angularçš„æäº¤è§„èŒƒï¼ˆä¾‹ï¼šfix(account): ä¿®å¤xxxçš„bug ï¼‰

```
<type>(<scope>): <subject>  // è¿™éƒ½æ˜¯header
// ç©ºä¸€è¡Œ
<body>
// ç©ºä¸€è¡Œ
<footer>

ç¬¬ä¸€è¡Œæ˜¯Headerï¼Œæ˜¯å¿…éœ€çš„
Body å’Œ Footer æ˜¯å¯ä»¥çœç•¥
Headerä¸­ï¼Œtypeã€subjectæ˜¯å¿…é¡»çš„ï¼Œscopeæ˜¯å¯çœç•¥çš„

type åªèƒ½æ˜¯ä¸‹é¢å…¶ä¸­ä¹‹ä¸€ï¼š
  'feat', // æ–°ç‰¹æ€§ã€æ–°åŠŸèƒ½ï¼ˆfeatureï¼‰
  'fix', // ä¿®bug
  'style', // ä»£ç æ ¼å¼ä¿®æ”¹,ä»£ç æ ¼å¼åŒ–ï¼Œæ³¨æ„ä¸æ˜¯ css ä¿®æ”¹ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰
  'chore', // æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
  'docs', // æ–‡æ¡£æ„å»ºä¸ä¿®æ”¹
  'conf', // é…ç½®æ–‡ä»¶ä¿®æ”¹
  'refactor', // ä»£ç é‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç å˜åŠ¨ï¼‰
  'test', // å¢åŠ æµ‹è¯•ã€æµ‹è¯•ç”¨ä¾‹ä¿®æ”¹
  'perf', // ä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒ

scope æ˜¯æäº¤ä»£ç æ¶‰åŠçš„é¢†åŸŸã€å½±å“çš„èŒƒå›´
	æ¯”å¦‚åç«¯çš„controllerã€serviceã€databaseï¼Œå‰ç«¯çš„viewsã€configç­‰ç­‰

subjectæ˜¯å¯¹  æ­¤æ¬¡æäº¤å†…å®¹çš„ç®€çŸ­æè¿°ï¼Œéœ€è¦è‡ªå·±ç¼–ï¼Œå•Šä¸ï¼Œå†™

Body æ˜¯å¯¹æœ¬æ¬¡ commit çš„è¯¦ç»†æè¿°ï¼Œå¯ä»¥åˆ†æˆå¤šè¡Œï¼Œä¸€èˆ¬å°±æ‡’çš„å†™

Footer æœ‰ä¸¤ç§æƒ…å†µ
1. å½“å‰æäº¤ä¼šäº§ç”Ÿä¸å…¼å®¹ååº”ï¼Œåº”è¯¥è¡¥å……å…¼å®¹æ–¹æ³•ï¼Œä»¥BREAKING CHANGEå¼€å¤´
2. å…³é—­issueï¼Œä¾‹ï¼šCloses #123, #245, #992ï¼Œ

è¿˜æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œæ¢å¤ä¹‹å‰çš„æŸæ¬¡æäº¤ï¼Œä»¥revertå¼€å¤´ï¼Œåé¢æ˜¯è¢«æ¢å¤çš„é‚£æ¬¡æäº¤ä¿¡æ¯çš„header
ä¾‹ï¼šrevert: type(scope):  some comment
This reverts commit bfe307ce57d87677c6c473c228e6c2ed8b81dcec.
```

> ä¸Šé¢è¿™äº›æäº¤è§„èŒƒï¼Œå› ä¸ºè§„èŒƒåªæ˜¯å£å¤´ä¸Šçš„ï¼Œéœ€è¦å·¥å…·æ¥çº¦æŸï¼Œäºæ˜¯æœ‰äº†commitlint/cliã€git-czä¹‹ç±»çš„æäº¤å·¥å…·

- å®‰è£…åŠé…ç½®

```
å…¨å±€å®‰è£…git-cz
> npm install -g git-cz

é¡¹ç›®ä¸­ä½¿ç”¨commitlintï¼š
> pnpm install --save-dev @commitlint/config-conventional @commitlint/cli

æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶.commitlintrc.jsï¼Œé‡Œé¢åŠ å…¥ï¼š
module.exports = {
    extends: ['@commitlint/config-conventional'],

    rules: {
        'type-enum': [
            2,
            'always',
            [
                'feat', // æ–°ç‰¹æ€§ã€æ–°åŠŸèƒ½ï¼ˆfeatureï¼‰
                'fix', // ä¿®bug
                'style', // ä»£ç æ ¼å¼ä¿®æ”¹,ä»£ç æ ¼å¼åŒ–ï¼Œæ³¨æ„ä¸æ˜¯ css ä¿®æ”¹ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰
                'chore', // æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
                'docs', // æ–‡æ¡£æ„å»ºä¸ä¿®æ”¹
                'conf', // é…ç½®æ–‡ä»¶ä¿®æ”¹
                'refactor', // ä»£ç é‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç å˜åŠ¨ï¼‰
                'test', // å¢åŠ æµ‹è¯•ã€æµ‹è¯•ç”¨ä¾‹ä¿®æ”¹
                'perf', // ä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒ
            ],
        ],

        'header-max-length': [2, 'never', 72], // header æœ€é•¿72

        'type-empty': [2, 'never'], // <type> ä¸èƒ½ä¸ºç©º
        'type-case': [2, 'always', 'lower-case'], // <type>æ ¼å¼å°å†™

        // 'scope-empty': [2, 'never'], // <scope> ä¸èƒ½ä¸ºç©º
        'scope-case': [2, 'always', 'lower-case'], // <scope> æ ¼å¼ å°å†™

        // <subject> æ ¼å¼
        // å¯é€‰å€¼
        // 'lower-case' å°å†™ lowercase
        // 'upper-case' å¤§å†™ UPPERCASE
        // 'camel-case' å°é©¼å³° camelCase
        // 'kebab-case' çŸ­æ¨ªçº¿ kebab-case
        // 'pascal-case' å¤§é©¼å³° PascalCase
        // 'sentence-case' é¦–å­—æ¯å¤§å†™ Sentence case
        // 'snake-case' ä¸‹åˆ’çº¿ snake_case
        // 'start-case' æ‰€æœ‰é¦–å­—æ¯å¤§å†™ start-case
        'subject-empty': [2, 'never'], // <subject> ä¸èƒ½ä¸ºç©º
        'subject-full-stop': [2, 'never', '.'], // <subject> ä»¥.ä¸ºç»“æŸæ ‡å¿—
        'subject-case': [2, 'never', []],

        'body-leading-blank': [2, 'always'], // bodyæ¢è¡Œ

        'footer-leading-blank': [1, 'always'], // <footer> ä»¥ç©ºè¡Œå¼€å¤´
    },
}


è¿˜è¦ä¸º git é…ç½® husky ï¼Œå¯¹ git çš„ commit æ“ä½œè¿›è¡Œæ ¡éªŒ
huskyç»§æ‰¿äº†Gitä¸‹æ‰€æœ‰çš„é’©å­ï¼Œåœ¨è§¦å‘é’©å­çš„æ—¶å€™ï¼Œhuskyå¯ä»¥é˜»æ­¢ä¸åˆæ³•çš„commitï¼Œpushç­‰ç­‰
ï¼ï¼ï¼å®‰è£…ä¸€å®šè¦æ˜¯4.3.8ç‰ˆæœ¬çš„ï¼Œç°åœ¨æœ€æ–°æ˜¯7.x.yï¼Œ7ä»£çš„ä¸å¥½ç”¨ï¼Œæ‹¦æˆªä¸ä¸‹æ¥ï¼ˆctmdè¡€å‘
> pnpm install husky@4.3.8 --save-dev 


package.jsoné‡Œé¢å¼•å…¥huskyã€‚ã€‚ä¸‹é¢è¿™æ®µé…ç½®å‘Šè¯‰äº†git hooksï¼Œå½“æˆ‘ä»¬åœ¨å½“å‰é¡¹ç›®ä¸­æ‰§è¡Œ git commit -m 'æµ‹è¯•æäº¤' æ—¶å°†è§¦å‘commit-msgäº‹ä»¶é’©å­å¹¶é€šçŸ¥huskyï¼Œä»è€Œæ‰§è¡Œ commitlint -E HUSKY_GIT_PARAMSå‘½ä»¤
ä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšå¼€å§‹å®‰è£…çš„./node_modules/.bin/commitlintï¼Œå®ƒå°†è¯»å–commitlint.config.jsé…ç½®è§„åˆ™å¹¶å¯¹æˆ‘ä»¬åˆšåˆšæäº¤çš„æµ‹è¯•æäº¤è¿™ä¸²æ–‡å­—è¿›è¡Œæ ¡éªŒï¼Œè‹¥æ ¡éªŒä¸é€šè¿‡ï¼Œåˆ™åœ¨ç»ˆç«¯è¾“å‡ºé”™è¯¯ï¼Œcommitç»ˆæ­¢ã€‚
{
  ...
  ...
  "husky": {
    "hooks": {
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS"
    }  
  }
}

è¿™æ˜¯æœ€åä¸€æ­¥äº†ï¼ŒåšæŒä¸€ä¸‹ï¼Œé©¬ä¸Šå°±èƒ½ç”¨äº†
git-czçš„æç¤ºä¿¡æ¯ä¹Ÿè¦é…ç½®ä¸€ä¸‹ï¼Œé¡¹ç›®æ ¹ç›®å½•åˆ›å»ºæ–‡ä»¶changelog.config.jsï¼Œç„¶åå†™å…¥ï¼š
module.exports = {
    disableEmoji: false,
    format: '{type}{scope}: {emoji}{subject}',
    list: [
        'feat', // æ–°ç‰¹æ€§ã€æ–°åŠŸèƒ½ï¼ˆfeatureï¼‰
        'fix', // ä¿®bug
        'chore', // æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
        'docs', // æ–‡æ¡£æ„å»ºä¸ä¿®æ”¹
        'style', // ä»£ç æ ¼å¼ä¿®æ”¹,ä»£ç æ ¼å¼åŒ–ï¼Œæ³¨æ„ä¸æ˜¯ css ä¿®æ”¹ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰
        'perf', // ä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒ
        'refactor', // ä»£ç é‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç å˜åŠ¨ï¼‰
        'ci', // è‡ªåŠ¨é›†æˆ
        'test', // å¢åŠ æµ‹è¯•ã€æµ‹è¯•ç”¨ä¾‹ä¿®æ”¹
    ],
    maxMessageLength: 64,
    minMessageLength: 3,
    questions: [
        'type',
        'scope',
        'subject',
        // 'body',
        // 'breaking',
        // 'issues',
        // 'lerna',
    ],
    scopes: ['', 'config', 'router', 'dependence'],
    types: {
        chore: {
            description: 'Build process or auxiliary tool changes',
            emoji: 'ğŸ› ',
            value: 'chore',
        },
        ci: {
            description: 'CI related changes',
            emoji: 'ğŸ¡',
            value: 'ci',
        },
        docs: {
            description: 'Documentation only changes',
            emoji: 'âœï¸',
            value: 'docs',
        },
        feat: {
            description: 'A new feature',
            emoji: 'ğŸ¸',
            value: 'feat',
        },
        fix: {
            description: 'A bug fix',
            emoji: 'ğŸ›',
            value: 'fix',
        },
        perf: {
            description: 'A code change that improves performance',
            emoji: 'âš¡ï¸',
            value: 'perf',
        },
        refactor: {
            description:
                'A code change that neither fixes a bug or adds a feature',
            emoji: 'ğŸ’¡',
            value: 'refactor',
        },
        release: {
            description: 'Create a release commit',
            emoji: 'ğŸ¹',
            value: 'release',
        },
        style: {
            description:
                'Markup, white-space, formatting, missing semi-colons...',
            emoji: 'ğŸ’„',
            value: 'style',
        },
        test: {
            description: 'Adding missing tests',
            emoji: 'ğŸ’',
            value: 'test',
        },
    },
}


```

- ä½¿ç”¨

```
é¦™é¦™æ—¶åˆ»åˆ°ï¼Œåœ¨è¦æäº¤çš„æ—¶å€™ï¼Œåªéœ€è¦ä¸€ä¸ªå‘½ä»¤ï¼Œç„¶åæŒ‰ç…§æç¤ºé€‰æ‹©ã€å¡«å†™æäº¤ä¿¡æ¯å³å¯ï¼ï¼
> git-cz
```







### HhuilderX Vscode è·³åˆ° å˜é‡å®šä¹‰å¤„

> ä¸åŒçš„ç¼–è¾‘å™¨é‡Œä¸å¤ªä¸€æ ·ï¼Œè‡ªå·±è¯•å§

alt + å·¦é”®

ctrl + å·¦é”®

command + å·¦é”®





## Funs